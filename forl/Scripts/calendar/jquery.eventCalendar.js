$.fn.eventCalendar = function (n) { function o(n, t) { return n.date.toLowerCase() > t.date.toLowerCase() ? 1 : -1 } function u(n, u, f) { var a = $("<div class='eventsCalendar-slider'><\/div>"), c = $("<div class='eventsCalendar-monthWrap'><\/div>"), p = $("<div class='eventsCalendar-currentTitle'><a href='#' class='arrow prev'><span>" + i.txt_prev + "<\/span><\/a><a href='#' class='arrow next'><span>" + i.txt_next + "<\/span><\/a><a href='#' class='monthTitle'><\/a><\/div>"), l = $("<ul class='eventsCalendar-daysList'><\/ul>"), o = new Date, v, w, s, e, h, y; t.wrap.find(".eventsCalendar-slider").size() ? t.wrap.find(".eventsCalendar-slider").append(c) : (t.wrap.prepend(a), a.append(c)); t.wrap.find(".eventsCalendar-monthWrap.currentMonth").removeClass("currentMonth").addClass("oldMonth"); c.addClass("currentMonth").append(p, l); n === "current" ? day = o.getDate() : (o = new Date(t.wrap.attr("data-current-year"), t.wrap.attr("data-current-month"), 1, 0, 0, 0), day = 0, moveOfMonth = 1, n === "prev" && (moveOfMonth = -1), o.setMonth(o.getMonth() + moveOfMonth), v = new Date, o.getMonth() === v.getMonth() && (day = v.getDate())); var u = o.getFullYear(), b = (new Date).getFullYear(), f = o.getMonth(), k = f + 1; if (n != "current" && r(i.eventsLimit, u, f, !1, n), t.wrap.attr("data-current-month", f).attr("data-current-year", u), p.find(".monthTitle").html(i.monthNames[f] + " " + u), w = 32 - new Date(u, f, 32).getDate(), s = [], i.showDayAsWeeks) { if (l.addClass("showAsWeek"), i.showDayNameInCalendar) for (l.addClass("showDayNames"), e = 0, i.startWeekOnMonday && (e = 1) ; e < 7; e++) s.push('<li class="eventsCalendar-day-header">' + i.dayNamesShort[e] + "<\/li>"), e === 6 && i.startWeekOnMonday && s.push('<li class="eventsCalendar-day-header">' + i.dayNamesShort[0] + "<\/li>"); for (dt = new Date(u, f, 01), h = dt.getDay(), i.startWeekOnMonday && (h = dt.getDay() - 1), h < 0 && (h = 6), e = h; e > 0; e--) s.push('<li class="eventsCalendar-day empty"><\/li>') } for (dayCount = 1; dayCount <= w; dayCount++) y = "", day > 0 && dayCount === day && u === b && (y = "today"), s.push('<li id="dayList_' + dayCount + '" rel="' + dayCount + '" class="eventsCalendar-day ' + y + '"><a href="#">' + dayCount + "<\/a><\/li>"); l.append(s.join("")); a.css("height", c.height() + "px") } function s(n) { var t = n.length, i = n.charAt(t - 1), r; return r = t === 2 && n.charAt(0) === "1" ? "" : n === "1" ? "&ordm;" : i === "2" ? "" : i === "3" ? "" : "", n + r } function r(n, r, u, e, o) { var n = n || 0, r = r || "", e = e || "", u; u = typeof u != "undefined" ? u : ""; t.wrap.find(".eventsCalendar-loading").fadeIn(); i.jsonData ? (i.cacheJson = !0, t.eventsJson = i.jsonData, f(t.eventsJson, n, r, u, e, o)) : i.cacheJson && o ? f(t.eventsJson, n, r, u, e, o) : $.getJSON(i.eventsjson + "?limit=" + n + "&year=" + r + "&month=" + u + "&day=" + e, function (i) { t.eventsJson = i; f(t.eventsJson, n, r, u, e, o) }).error(function () { c("error getting json: ") }); e > "" && (t.wrap.find(".current").removeClass("current"), t.wrap.find("#dayList_" + e).addClass("current")) } function f(n, r, u, f, h, c) { directionLeftMove = "-=" + t.directionLeftMove; eventContentHeight = "auto"; subtitle = t.wrap.find(".eventsCalendar-list-wrap .eventsCalendar-subtitle"); c ? (h != "" ? subtitle.html(s(h) + " de " + i.monthNames[f]) : subtitle.html(i.txt_SpecificEvents_prev + i.monthNames[f] + " " + i.txt_SpecificEvents_after), c === "prev" ? directionLeftMove = "+=" + t.directionLeftMove : (c === "day" || c === "month") && (directionLeftMove = "+=0", eventContentHeight = 0)) : (subtitle.html(i.txt_NextEvents), eventContentHeight = "auto", directionLeftMove = "-=0"); t.wrap.find(".eventsCalendar-list").animate({ opacity: i.moveOpacity, left: directionLeftMove, height: eventContentHeight }, i.moveSpeed, function () { var e, l, s, c; t.wrap.find(".eventsCalendar-list").css({ left: 0, height: "auto" }).hide(); e = []; n = $(n).sort(o); n.length && (l = "", i.showDescription || (l = "hidden"), s = "_self", i.openEventInNewWindow && (s = "_self"), c = 0, $.each(n, function (n, o) { var w; if (i.jsonDateFormat == "human") var b = o.date.split(" "), l = b[0].split("-"), v = l[0], a = parseInt(l[1]) - 1, y = l[2], k = parseInt(a) + 1, l = new Date(v, a, y); else var l = new Date(parseInt(o.date)), v = l.getFullYear(), a = l.getMonth(), y = l.getDate(), k = a + 1, d = l.getHours(), p = l.getMinutes(); parseInt(p) <= 9 && (p = "0" + parseInt(p)); (r === 0 || r > c) && (f === !1 || f == a) && (h == "" || h == y) && (u == "" || u == v) && (f === !1 && l < new Date || (eventStringDate = "", h === "" && (eventStringDate = "<p>" + y + "/" + k + "/" + v + "<\/p>"), w = o.url ? '<a href="' + o.url + '" target="' + s + '" class="eventTitle" style="text-decoration:none;">' + o.title + "<\/a><br />" : '<span class="eventTitle">' + o.title + "<\/span>", e.push('<li id="' + n + '" class="' + o.type + '"><time datetime="' + l + '"><em>' + eventStringDate + "<\/em><\/time>" + w + "<\/li>"), c++)); v == t.wrap.attr("data-current-year") && a == t.wrap.attr("data-current-month") && t.wrap.find(".currentMonth .eventsCalendar-daysList #dayList_" + parseInt(y)).addClass("dayWithEvents") })); e.length || e.push('<li class="eventsCalendar-noEvents"><p>' + i.txt_noEvents + "<\/p><\/li>"); t.wrap.find(".eventsCalendar-loading").hide(); t.wrap.find(".eventsCalendar-list").html(e.join("")); t.wrap.find(".eventsCalendar-list").animate({ opacity: 1, height: "toggle" }, i.moveSpeed) }); e() } function h() { t.wrap.find(".arrow").click(function (n) { var r; n.preventDefault(); $(this).hasClass("next") ? (u("next"), r = "-=" + t.directionLeftMove) : (u("prev"), r = "+=" + t.directionLeftMove); t.wrap.find(".eventsCalendar-monthWrap.oldMonth").animate({ opacity: i.moveOpacity, left: r }, i.moveSpeed, function () { t.wrap.find(".eventsCalendar-monthWrap.oldMonth").remove() }) }) } function c() { } function e() { } var i = $.extend({}, $.fn.eventCalendar.defaults, n), t = { wrap: "", directionLeftMove: "300", eventsJson: {} }; this.each(function () { t.wrap = $(this); t.wrap.addClass("eventCalendar-wrap").append("<div class='eventsCalendar-list-wrap'><p class='eventsCalendar-subtitle'>Eventos<\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><p>03/11/2015 - 06/11/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>VI Curso de Radiologia em Otorrinolaringologia à Distância<\/a><\/p><p>01/12/2015 - 03/12/2015 <a style='text-decoration:none;' class='eventTitle' href='#'>Curso Teórico Prático de Endoscopia Dirigida ao ORL - Módulo I e II<\/a><\/p><div class='eventsCalendar-list-content'><ul class='eventsCalendar-list'><\/ul><\/div><\/div>"); i.eventsScrollable && t.wrap.find(".eventsCalendar-list-content").addClass("scrollable"); e(); $(window).resize(function () { e() }); u("current"); r(i.eventsLimit, !1, !1, !1, !1); h(); t.wrap.on("click", ".eventsCalendar-day a", function (n) { n.preventDefault(); var f = t.wrap.attr("data-current-year"), e = t.wrap.attr("data-current-month"), u = $(this).parent().attr("rel"); u <= 9 && (u = "0" + u); r(i.eventsLimit, f, e, u, "day") }); t.wrap.on("click", ".monthTitle", function (n) { n.preventDefault(); var u = t.wrap.attr("data-current-year"), f = t.wrap.attr("data-current-month"); r(i.eventsLimit, u, f, !1, "month") }) }); t.wrap.find(".eventsCalendar-list").on("click", ".eventTitle", function (n) { var r, u, f; i.showDescription || (n.preventDefault(), r = $(this).parent().find(".eventDesc"), r.find("a").size() || (u = $(this).attr("href"), f = $(this).attr("target"), r.append('<br><a href="' + u + '" target="' + f + '" class="btEvento">' + i.txt_GoToEventUrl + "<\/a>")), r.is(":visible") ? r.slideUp() : (i.onlyOneDescription && t.wrap.find(".eventDesc").slideUp(), r.slideDown())) }) }; $.fn.eventCalendar.defaults = { eventsLimit: 10, dayNames: ["Domingo", "Segunda", "Ter&ccedil;a", "Quarta", "Quinta", "Sexta", "S&aacute;bado"], txt_noEvents: "N&atilde;o existem eventos para este per&iacute;odo", txt_SpecificEvents_prev: "", txt_SpecificEvents_after: "", txt_next: "pr&oacute;ximo", txt_prev: "", txt_NextEvents: "Pr&oacute;ximo evento:", txt_GoToEventUrl: "Veja o Evento", showDayAsWeeks: !0, startWeekOnMonday: !0, showDayNameInCalendar: !0, showDescription: !0, onlyOneDescription: !0, openEventInNewWindow: !0, eventsScrollable: !0, jsonDateFormat: "timestamp", moveSpeed: 500, moveOpacity: .15, jsonData: "", cacheJson: !0 };
